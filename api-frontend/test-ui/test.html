<!DOCTYPE html>
<html lang="de">

<head>
    <link rel="stylesheet" href="bootstrap.min.css">
    <script src="jquery-3.4.1.slim.min.js"></script>
    <script src="popper.min.js"></script>
    <script src="bootstrap.min.js"></script>
    <meta charset="utf-8">
    <title>Test</title>
    <script>
        (function () {
            'use strict';
            window.addEventListener('load', function () {
                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                const forms = document.querySelectorAll('form[r-form]');

                Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        } else {
                            const formName = form.getAttribute("r-form");
                            console.log(formName);
                            submitForm(formName);
                            event.preventDefault();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);

            function submitForm(formName) {
                const form = document.querySelector("[r-form=\"" + formName + "\"]");
                const data = {};
                for (let element of form.querySelectorAll("[name]")) {
                    const name = element.name;
                    if (
                        element instanceof HTMLInputElement ||
                        element instanceof HTMLTextAreaElement ||
                        element instanceof HTMLSelectElement
                    )
                        if (element.type === 'checkbox')
                            data[name] = element.checked ? 'Ja' : 'Nein';
                        else if (typeof name === 'string' && ['submit'].indexOf(name) < 0 && element.value && element.value.length > 0)
                            data[name] = element.value;

                }
                const url = "https://api.reisishot.pictures/send.php";

                const request = new XMLHttpRequest();
                request.open("POST", url);
                request.send(JSON.stringify(data));
                form.style = "display: none";
                const element = document.querySelector("[r-form-submitted=\"" + formName + "\"]");
                element.style = "";
            }
        })();
    </script>
</head>

<body>
<div class="formContainer"><h2>Kontaktiere mich</h2>
    <form class="needs-validation" novalidate r-form="footer">
        <div class="form-row">
            <div class="col">
                <div class="form-group"><label for="Name" aria-describedby="NameHelp">Name</label>
                    <input type="text"
                           class="form-control"
                           id="Name"
                           name="Name"
                           required="required">
                    <div class="invalid-feedback">Bitte sag mir wie du heißt</div>
                    <small id="NameHelp">Dein Name</small></div>
            </div>
            <div class="col">
                <div class="form-group"><label for="E-Mail" aria-describedby="E-MailHelp">E-Mail Adresse</label><input
                        type="email" class="form-control" id="E-Mail" name="E-Mail" required="required">
                    <div class="invalid-feedback">Ich brauche deine E-Mail-Adresse um dir zu antworten</div>
                    <small id="E-MailHelp">Deine E-Mail-Adresse, auf die du deine Antwort bekommst</small></div>
            </div>
        </div>
        <div class="form-group"><label for="freitext" aria-describedby="freitextHelp">Deine Nachricht an
            mich:</label><textarea rows="6" class="control" required="required" name="freitext"
                                   id="freitext"></textarea>
            <div class="invalid-feedback">Bitte gib eine Nachricht ein</div>
            <small id="freitextHelp">z.B.: Shooting Anfragen (Bitte Link zu Portfolio einfügen) oder Feedback zu meiner
                Seite oder meinen Bildern.</small></div>
        <div class="form-check"><input type="checkbox" required="required" name="zustimmung" id="zustimmung"
                                       value=""><label class="form-check-label" for="zustimmung"
                                                       aria-describedby="zustimmungHelp">Ich akzeptiere, dass der Inhalt
            dieses Formulars per Mail zugestellt wird.</label>
            <div class="invalid-feedback">Leider benötige ich deine Einwilligung, damit</div>
            <p><small id="zustimmungHelp">Natürlich wird diese E-Mail-Adresse nur zum Zwecke deiner Anfrage verwendet
                und nicht mit Dritten geteilt</small></p></div>
        <div>
            <button class="btn btn-primary">Absenden</button>
        </div>
    </form>
    <div r-form-submitted="footer" style="display: none"><h3>Vielen Dank für deine Nachricht! Ich melde mich
        schnellstmöglich!</h3></div>
</div>
</body>

</html>